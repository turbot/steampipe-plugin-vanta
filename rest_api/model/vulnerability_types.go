package model

import (
	"time"
)

// ListVulnerabilitiesOptions represents options for listing vulnerabilities
type ListVulnerabilitiesOptions struct {
	Limit                             int        `json:"limit,omitempty"`
	Cursor                            string     `json:"cursor,omitempty"`
	Severity                          string     `json:"severity,omitempty"`
	IsFixAvailable                    *bool      `json:"isFixAvailable,omitempty"`
	IsDeactivated                     *bool      `json:"isDeactivated,omitempty"`
	IntegrationID                     string     `json:"integrationId,omitempty"`
	VulnerableAssetID                 string     `json:"vulnerableAssetId,omitempty"`
	SLADeadlineBeforeDate             *time.Time `json:"slaDeadlineBeforeDate,omitempty"`
	SLADeadlineAfterDate              *time.Time `json:"slaDeadlineAfterDate,omitempty"`
	IncludeVulnerabilitiesWithoutSLAs *bool      `json:"includeVulnerabilitiesWithoutSlas,omitempty"`
}

// ListVulnerabilitiesOutput represents the response from the list vulnerabilities API
type ListVulnerabilitiesOutput struct {
	Results VulnerabilityResults `json:"results"`
}

// VulnerabilityResults contains the actual vulnerability data and pagination info
type VulnerabilityResults struct {
	PageInfo PageInfo         `json:"pageInfo"`
	Data     []*Vulnerability `json:"data"`
}

// DeactivateMetadata contains deactivation/ignored status information
type DeactivateMetadata struct {
	IsVulnDeactivatedIndefinitely bool       `json:"isVulnDeactivatedIndefinitely"`
	DeactivatedUntilDate          *time.Time `json:"deactivatedUntilDate,omitempty"`
	DeactivationReason            string     `json:"deactivationReason,omitempty"`
	DeactivatedOnDate             *time.Time `json:"deactivatedOnDate,omitempty"`
	DeactivatedBy                 string     `json:"deactivatedBy,omitempty"`
}

// Vulnerability represents a vulnerability in the Vanta system
type Vulnerability struct {
	ID                  string              `json:"id"`
	Name                string              `json:"name"`                          // CVE identifier
	Description         string              `json:"description"`
	Severity            string              `json:"severity"`                      // CRITICAL, HIGH, MEDIUM, LOW
	CVSSSeverityScore   *float64            `json:"cvssSeverityScore,omitempty"`
	RemediateByDate     *time.Time          `json:"remediateByDate,omitempty"`     // SLA deadline
	IsFixable           bool                `json:"isFixable"`
	DeactivateMetadata  *DeactivateMetadata `json:"deactivateMetadata,omitempty"`  // Deactivation/ignored info
	FirstDetectedDate   *time.Time          `json:"firstDetectedDate,omitempty"`
	SourceDetectedDate  *time.Time          `json:"sourceDetectedDate,omitempty"`  // When source scanner first detected
	LastDetectedDate    *time.Time          `json:"lastDetectedDate,omitempty"`
	IntegrationID       string              `json:"integrationId"`
	TargetID            string              `json:"targetId,omitempty"`
	PackageIdentifier   string              `json:"packageIdentifier,omitempty"`
	VulnerableAssetID   string              `json:"vulnerableAssetId,omitempty"`
	ExternalURL         string              `json:"externalUrl,omitempty"`         // Link to CVE details
	VulnerabilityType   string              `json:"vulnerabilityType,omitempty"`
	ScannerScore        *float64            `json:"scannerScore,omitempty"`
	ScanSource          string              `json:"scanSource,omitempty"`          // Scanning tool that detected the vulnerability
	RelatedVulns        []string            `json:"relatedVulns,omitempty"`
	RelatedURLs         []string            `json:"relatedUrls,omitempty"`
}
